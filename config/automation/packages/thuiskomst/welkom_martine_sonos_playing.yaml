  alias: Welkom Martine, sonos playing
  hide_entity: false
  trigger:
    platform: state
    entity_id: binary_sensor.keuken_6_3
    to: 'on'
    for:
      seconds: 3
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: media_player.keuken
        state: playing
      - condition: state
        entity_id: input_boolean.giel_komt_thuis
        state: 'off'
      - condition: state
        entity_id: input_boolean.martine_komt_thuis
        state: 'on'
      - condition: template
        value_template: "{{as_timestamp(now()) - as_timestamp(state_attr('script.sonos_pauze_spreek', 'last_triggered')) | float > 200 }}"
      - condition: template
        value_template: "{{as_timestamp(now()) - as_timestamp(state_attr('script.sonos_playing_spreek', 'last_triggered')) | float > 200 }}"
  action:
    - service: script.sonos_playing_spreek
      data_template:
        sonos_entity: media_player.keuken
        volume: 0.55
        delay: '00:00:08'
        speech_message: >
           {% set person = 'Martine' %}
           {{ [
           "Hallo " + person + ", welkom thuis.",
           "Hallo " + person,
           "Welkom thuis " + person + ", zware dag gehad?",
           "Blij dat je thuis bent " + person ,
           "Hokus Pokus pats, ik wou da " + person + " thuis was",
           "De rechterhand van de almachtige is aanwezig.",
           "Spiegeltje, spiegeltje aan de wand, hier is de mooiste van het land.",
           "Sims salla bime, hier is " + person ,
           "Die da Disneyland, hier is " + person + " en dat is plezent.",
           "Kostelijke kip in the house",
           "Sorry, voor de rommel in huis,. Neem de stofzuiger en voel je thuis!"
           ] | random }}
