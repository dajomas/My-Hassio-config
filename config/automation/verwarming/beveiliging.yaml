  alias: 'beveiliging verwarming'

  trigger:
    - platform: time_pattern
      minutes: '/5'
      seconds: 00
    
  action:
    - service: switch.turn_off
      # entity_id: switch.badkamer, switch.fien, switch.noor, switch.slaapkamer, switch.wc
      data_template:
        entity_id: >-
          {% set switches = ["switch.badkamer", "switch.fien", "switch.noor", "switch.slaapkamer", "switch.wc"] %}
          {% set heating = [] %}
          {% for switch in switches %}
            {% set et = switch %}
            {% if states(et) == 'off' %}
              {{ heating.append(et)  }}
            {% endif %}
          {% endfor %}
          {{ heating|join(',') }}




          {% set switches = ["switch.badkamer", "switch.fien", "switch.noor", "switch.slaapkamer", "switch.wc"] %}
          {% for switch in switches %}
            {% set et = switch %}
            {% if states(et) == 'off' %}
              {{ et }}
            {% endif %}
          {% endfor %}